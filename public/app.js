// Generated by CoffeeScript 1.10.0
(function() {
  var HOST;

  HOST = "http://127.0.0.1:3000";

  angular.module('west', ['ui.bootstrap', 'west-router', 'west-dbms']).directive('ckEditor', function() {
    return {
      require: '?ngModel',
      link: function(scope, elm, attr, ngModel) {
        var ck;
        ck = CKEDITOR.replace(elm[0]);
        if (!ngModel) {
          return;
        }
        ck.on('pasteState', function() {
          return scope.$apply(function() {
            return ngModel.$setViewValue(ck.getData());
          });
        });
        return ngModel.$render = function(value) {
          return ck.setData(ngModel.$viewValue);
        };
      }
    };
  }).filter('richtext', [
    '$sce', function($sce) {
      return function(html) {
        return $sce.trustAsHtml(html);
      };
    }
  ]).controller('main', function($scope, $timeout, DBMS, $route) {
    var update;
    $scope.router = $route;
    $scope.now = new Date();
    update = function() {
      $scope.now = new Date();
      return $timeout(update, 1000);
    };
    update();
    $scope.slides = DBMS.slides;
    DBMS.news.refresh();
    $scope.news_list = DBMS.news.data;
    $scope.news_dic = DBMS.news.dic;
    $scope.about = DBMS.about;
    $scope.notify = DBMS.notify;
    $scope.contact = DBMS.contact;
    return $scope.policy_list = DBMS.policy_list;
  }).controller('login', function($scope, $http, $location) {
    $scope.form = {
      username: "",
      password: ""
    };
    return $scope.login = function() {
      return $http.post(HOST + "/users/login", $scope.form).then(function(res) {
        console.log(res.data);
        alert("Login successfully.");
        return $location.path('/').replace();
      })["catch"](function(res) {
        var err;
        err = res.data;
        return alert(err.message);
      });
    };
  }).controller('publish', function($scope, DBMS) {
    $scope.form = DBMS.publish_news;
    return $scope.publish = function() {
      return DBMS.publish_news.create().then(function() {
        DBMS.publish_news.title = "";
        return DBMS.publish_news.content = "";
      });
    };
  }).controller('update', function($scope, DBMS, $route) {
    var news_id;
    news_id = $route.current.params.news_id;
    DBMS.publish_news.title = DBMS.news.dic[news_id].title;
    DBMS.publish_news.content = DBMS.news.dic[news_id].content;
    $scope.form = DBMS.publish_news;
    return $scope.publish = function() {
      return DBMS.publish_news.update(news_id).then(function() {
        DBMS.publish_news.title = "";
        return DBMS.publish_news.content = "";
      });
    };
  });

}).call(this);

//# sourceMappingURL=app.js.map
